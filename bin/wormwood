#!/usr/bin/env ruby

require 'commander/import'
require 'wormwood'

program :name, 'wormwood'
program :version, Wormwood::VERSION
program :description, 'Event-driven template rendering inspired by Jekyll.'

default_command :watch

global_option '-s', '--source [DIR]', 'Watches specified directory path (defaults to ./)'
global_option '-d', '--destination [DIR]', 'Writes to specified directory path (defaults to ./)'

command :watch do |c|
  c.syntax = 'wormwood watch [options]'
  c.description = 'Watches source directory and renders any files that change'
  c.action do |args, options|
    options.default \
      :source => './',
      :destination  => './'
    Wormwood.watch(options)
  end
end

command :build do |c|
  c.syntax = 'wormwood build [options]'
  c.description = 'Renders all templates in source directory'
  c.action do |args, options|
    options.default \
      :source => './',
      :destination  => './'
    Wormwood.build(Dir[Wormwood::GLOB], options)
  end
end
